<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Galeri Tycoon: Sanayi & Mafya</title>
<style>
    body { margin: 0; background: #050505; color: #fff; font-family: 'Segoe UI', sans-serif; overflow: hidden; }
    #ui { position: absolute; width: 100%; height: 100%; pointer-events: none; z-index: 10; display: flex; flex-direction: column; justify-content: space-between; padding: 20px; box-sizing: border-box; }
    .panel { pointer-events: auto; background: rgba(15,15,15,0.95); border: 1px solid #444; border-radius: 12px; padding: 15px; box-shadow: 0 4px 20px rgba(0,0,0,0.5); }
    
    /* ÃœST PANEL */
    .top-bar { display: flex; gap: 15px; justify-content: center; align-self: center; }
    .bar-container { width: 100px; height: 10px; background: #222; border-radius: 5px; margin-top: 5px; overflow: hidden; }
    .bar-fill { height: 100%; transition: 0.3s; }

    /* BÃ–LGE NAVIGATION */
    .nav-panel { position: absolute; left: 20px; top: 150px; display: flex; flex-direction: column; gap: 10px; }
    .nav-btn { background: #34495e; color: white; border: none; padding: 10px; border-radius: 5px; cursor: pointer; text-align: left; }
    .nav-btn.active { background: #e67e22; }

    /* KONTROLLER */
    .bottom-ui { display: flex; justify-content: space-between; align-items: flex-end; }
    .car-card { width: 300px; text-align: center; }
    .npc-dialog { width: 350px; border-left: 4px solid #e67e22; }

    button { width: 100%; padding: 10px; margin: 5px 0; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; color: white; transition: 0.2s; }
    button:hover { filter: brightness(1.2); transform: translateY(-2px); }
    .btn-buy { background: #27ae60; }
    .btn-sell { background: #2980b9; }
    .btn-action { background: #8e44ad; }
    
    #overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.8); display: none; z-index: 100; align-items: center; justify-content: center; pointer-events: auto; }
</style>
</head>
<body>

<div id="overlay">
    <div class="panel" id="modal-content" style="max-width: 400px; text-align: center;"></div>
</div>

<div id="ui">
    <div class="panel top-bar">
        <div style="text-align:center">ğŸ’° <span id="val-money" style="color:#2ecc71">â‚º300k</span></div>
        <div>ğŸ• AÃ§lÄ±k <div class="bar-container"><div id="bar-hunger" class="bar-fill" style="background: #e74c3c; width: 20%"></div></div></div>
        <div>ğŸ§˜ Stres <div class="bar-container"><div id="bar-stress" class="bar-fill" style="background: #9b59b6; width: 10%"></div></div></div>
        <div>ğŸ•Œ Ä°man <div class="bar-container"><div id="bar-faith" class="bar-fill" style="background: #f1c40f; width: 50%"></div></div></div>
        <div style="color:#3498db">ğŸ“… <span id="val-day">Pazartesi</span></div>
    </div>

    <div class="nav-panel">
        <button class="nav-btn active" onclick="changeLoc('galeri')">ğŸ¢ Galeri</button>
        <button class="nav-btn" onclick="changeLoc('sanayi')">ğŸ”§ Sanayi Sitesi</button>
        <button class="nav-btn" onclick="changeLoc('mahalle')">ğŸ  Mahalle / Cami</button>
    </div>

    <div class="bottom-ui">
        <div class="panel npc-dialog" id="npc-panel">
            <h4 id="npc-name" style="margin:0; color:#e67e22">NPC: Galericiler KralÄ±</h4>
            <p id="npc-text" style="font-size:0.9em">"HoÅŸgeldin evlat, bugÃ¼n ne alÄ±p satÄ±yoruz?"</p>
            <div id="pazarlik-box" style="display:none">
                <button class="btn-buy" onclick="pazarlikYap()">ğŸ¤ PazarlÄ±k Et</button>
                <button class="btn-sell" onclick="anlasmayiBitir()">âœ… El SÄ±kÄ±ÅŸ</button>
            </div>
        </div>

        <div class="panel car-card">
            <input type="text" id="gal-name" value="TUNA GALERÄ°" style="background:none; border:none; color:gold; font-weight:bold; width:100%; text-align:center; font-size:1.2em">
            <div id="car-view" style="font-size:4em; margin:10px 0">ğŸ¢</div>
            <h3 id="car-title">AraÃ§ Yok</h3>
            <p id="car-price" style="color:#aaa">Pazar FiyatÄ±: -</p>
            <button class="btn-buy" id="btn-buy-trigger" onclick="pazarAra()">ğŸš— Araba Ara</button>
            <button class="btn-sell" id="btn-sell-trigger" style="display:none" onclick="satisBaslat()">ğŸ’° MÃ¼ÅŸteri Bul</button>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
// OYUN VERÄ°LERÄ°
const cars = [
    {n:"TofaÅŸ Åahin", p:250000, c:0xffffff}, {n:"DoÄŸan SLX", p:320000, c:0xaaaaaa}, {n:"BMW M3", p:4500000, c:0x0000ff},
    {n:"Mercedes G63", p:15000000, c:0x222222}, {n:"Ferrari F40", p:45000000, c:0xff0000}
];
const npcs = ["EmlakÃ§Ä± Hayri", "HacÄ± Abi", "Tefeci Remzi", "Sanayi ustasÄ± Nuri", "Galerici Mahmut"];
let state = { money: 300000, hunger: 20, stress: 10, faith: 50, day: 0, loc: 'galeri', car: null, npcPrice: 0 };

// 3D SAHNE
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({antialias:true, alpha:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const carGroup = new THREE.Group();
const body = new THREE.Mesh(new THREE.BoxGeometry(2, 0.6, 4), new THREE.MeshStandardMaterial({color: 0xffffff}));
const roof = new THREE.Mesh(new THREE.BoxGeometry(1.6, 0.5, 2), new THREE.MeshStandardMaterial({color: 0xffffff}));
roof.position.y = 0.5;
carGroup.add(body, roof); scene.add(carGroup);
scene.add(new THREE.AmbientLight(0xffffff, 0.7));
const light = new THREE.PointLight(0xffffff, 1); light.position.set(10,10,10); scene.add(light);
camera.position.set(5, 3, 5); camera.lookAt(0,0,0);

function updateUI() {
    document.getElementById("val-money").innerText = "â‚º" + Math.floor(state.money/1000) + "k";
    document.getElementById("bar-hunger").style.width = state.hunger + "%";
    document.getElementById("bar-stress").style.width = state.stress + "%";
    document.getElementById("bar-faith").style.width = state.faith + "%";
    document.getElementById("val-day").innerText = ["Pzt", "Sal", "Ã‡ar", "Per", "Cum", "Cmt", "Paz"][state.day];

    if(state.car) {
        document.getElementById("car-title").innerText = state.car.n;
        document.getElementById("car-view").innerText = "ğŸš—";
        document.getElementById("car-price").innerText = "Piyasa: â‚º" + (state.car.p/1000) + "k";
        document.getElementById("btn-buy-trigger").style.display = "none";
        document.getElementById("btn-sell-trigger").style.display = "block";
        body.material.color.setHex(state.car.c); roof.material.color.setHex(state.car.c);
        carGroup.visible = true;
    } else {
        document.getElementById("car-title").innerText = "AraÃ§ Yok";
        document.getElementById("car-view").innerText = state.loc === 'galeri' ? "ğŸ¢" : state.loc === 'sanayi' ? "ğŸ”§" : "ğŸ•Œ";
        document.getElementById("btn-buy-trigger").style.display = "block";
        document.getElementById("btn-sell-trigger").style.display = "none";
        carGroup.visible = false;
    }
}

function changeLoc(l) {
    state.loc = l;
    document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
    event.target.classList.add('active');
    
    if(l === 'mahalle') {
        showModal("MAHALLE", "<button onclick='pray()'>ğŸ•Œ Namaz KÄ±l (Ä°man +30)</button><button onclick='eat()'>ğŸ›’ Yemek Ye (-â‚º2k)</button>");
    } else if(l === 'sanayi' && state.car) {
        showModal("SANAYÄ°", "<button onclick='modifiye()'>ğŸ› ï¸ Modifiye Et (Fiyat Artar - â‚º50k)</button>");
    }
    updateUI();
}

function pazarAra() {
    let car = cars[Math.floor(Math.random()*cars.length)];
    state.npcPrice = Math.floor(car.p * (0.9 + Math.random() * 0.2));
    document.getElementById("npc-name").innerText = npcs[Math.floor(Math.random()*npcs.length)];
    document.getElementById("npc-text").innerText = `"Selam, elimde temiz bir ${car.n} var. â‚º${(state.npcPrice/1000)}k olur."`;
    document.getElementById("pazarlik-box").style.display = "block";
    state.tempCar = car;
}

function pazarlikYap() {
    if(state.stress > 80) { showAlert("Ã‡ok streslisin, pazarlÄ±k yapamÄ±yorsun!"); return; }
    let chance = (state.faith / 100) + 0.2;
    if(Math.random() < chance) {
        state.npcPrice -= 20000;
        document.getElementById("npc-text").innerText = `"Tamam kÄ±rmayayÄ±m seni, â‚º${(state.npcPrice/1000)}k olsun."`;
    } else {
        state.stress += 10;
        document.getElementById("npc-text").innerText = `"Yoo, bu fiyatÄ±n altÄ±na inmem!"`;
    }
}

function anlasmayiBitir() {
    if(state.money >= state.npcPrice) {
        state.money -= state.npcPrice;
        state.car = state.tempCar;
        document.getElementById("pazarlik-box").style.display = "none";
        showAlert("HayÄ±rlÄ± olsun, arabayÄ± aldÄ±n!");
        updateUI();
    } else showAlert("Para Ã§Ä±kÄ±ÅŸmÄ±yor!");
}

function pray() { state.faith = Math.min(100, state.faith + 30); state.stress = Math.max(0, state.stress - 20); closeModal(); updateUI(); }
function eat() { if(state.money >= 2000) { state.money -= 2000; state.hunger = 0; } closeModal(); updateUI(); }
function modifiye() { if(state.money >= 50000) { state.money -= 50000; state.car.p += 150000; showAlert("Araba fena oldu!"); } closeModal(); updateUI(); }

function showModal(t, c) {
    const m = document.getElementById("overlay");
    document.getElementById("modal-content").innerHTML = `<h2>${t}</h2>${c}<br><button onclick="closeModal()">Kapat</button>`;
    m.style.display = "flex";
}
function closeModal() { document.getElementById("overlay").style.display = "none"; }
function showAlert(t) { alert(t); }

function animate() { requestAnimationFrame(animate); carGroup.rotation.y += 0.01; renderer.render(scene, camera); }
animate();
updateUI();
</script>
</body>
</html>
