<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Galerici SimÃ¼lasyonu 2024</title>
<style>
    :root {
        --bg-color: #1a1a1a;
        --panel-bg: #2a2a2a;
        --text-color: #e0e0e0;
        --accent-green: #4caf50;
        --accent-red: #f44336;
        --accent-blue: #2196f3;
        --accent-gold: #ffc107;
    }
    body { font-family: 'Segoe UI', sans-serif; background: var(--bg-color); color: var(--text-color); margin: 0; padding: 20px; display: flex; justify-content: center; }
    
    .container { width: 100%; max-width: 900px; display: grid; grid-template-columns: 1fr 2fr; gap: 20px; }
    
    /* PANELS */
    .panel { background: var(--panel-bg); padding: 15px; border-radius: 10px; box-shadow: 0 4px 6px rgba(0,0,0,0.3); margin-bottom: 20px; }
    .header { grid-column: 1 / -1; display: flex; justify-content: space-between; align-items: center; border-bottom: 2px solid #444; padding-bottom: 10px; }
    h2, h3 { margin: 0 0 10px 0; color: white; }
    
    /* BARS */
    .stat-row { margin-bottom: 8px; font-size: 14px; }
    .progress-bar { width: 100%; height: 12px; background: #444; border-radius: 6px; overflow: hidden; margin-top: 2px; }
    .progress-fill { height: 100%; transition: width 0.3s; }
    
    /* INPUTS & BUTTONS */
    button { cursor: pointer; border: none; padding: 10px 15px; border-radius: 5px; font-weight: bold; transition: 0.2s; width: 100%; margin-bottom: 5px; color: white; }
    button:hover { opacity: 0.9; transform: translateY(-1px); }
    button:disabled { opacity: 0.5; cursor: not-allowed; }
    
    .btn-buy { background: var(--accent-green); }
    .btn-sell { background: var(--accent-blue); }
    .btn-action { background: #555; }
    .btn-market { background: var(--accent-red); }
    .btn-mosque { background: var(--accent-gold); color: black; }
    .btn-next { background: #673ab7; margin-top: 10px; }
    .btn-upgrade { background: #e91e63; }

    input { padding: 5px; border-radius: 4px; border: 1px solid #555; background: #333; color: white; }

    /* LISTS */
    .car-item { background: #333; padding: 10px; margin-bottom: 5px; border-radius: 5px; display: flex; justify-content: space-between; align-items: center; font-size: 0.9em; }
    .offer-box { border: 2px dashed var(--accent-gold); padding: 15px; text-align: center; background: #322e22; animation: pulse 2s infinite; }
    
    @keyframes pulse { 0% { border-color: #ffc107; } 50% { border-color: #ff6f00; } 100% { border-color: #ffc107; } }

    .log-box { height: 150px; overflow-y: auto; font-size: 12px; color: #aaa; border-top: 1px solid #444; padding-top: 10px; }
    .log-item { margin-bottom: 4px; border-bottom: 1px solid #333; padding-bottom: 2px; }
    .bad { color: #ff6b6b; } .good { color: #6bff6b; } .info { color: #6bb6ff; }

    /* POPUP */
    #editNameSection { display: none; margin-top: 5px; }
</style>
</head>
<body>

<div class="container">
    <div class="panel header">
        <div>
            <h2 id="galleryNameDisplay">Tuna Galeri</h2>
            <small style="color:gray; cursor:pointer; text-decoration:underline;" onclick="toggleNameEdit()">Ä°sim DeÄŸiÅŸtir</small>
            <div id="editNameSection">
                <input type="text" id="newNameInput" placeholder="Yeni Ä°sim">
                <button onclick="changeName()" style="width:auto; padding:5px 10px; font-size:12px;">Kaydet</button>
            </div>
        </div>
        <div style="text-align: right;">
            <div style="font-size: 1.5em; color: var(--accent-green);" id="moneyDisplay">â‚º500,000</div>
            <div id="dayDisplay">GÃ¼n: 1</div>
        </div>
    </div>

    <div class="left-col">
        <div class="panel">
            <h3>Durum</h3>
            <div class="stat-row">
                AÃ§lÄ±k
                <div class="progress-bar"><div class="progress-fill" id="hungerBar" style="width: 0%; background: var(--accent-red);"></div></div>
            </div>
            <div class="stat-row">
                Stres
                <div class="progress-bar"><div class="progress-fill" id="stressBar" style="width: 0%; background: #9c27b0;"></div></div>
            </div>
            <div class="stat-row">
                Ä°man
                <div class="progress-bar"><div class="progress-fill" id="faithBar" style="width: 50%; background: var(--accent-gold);"></div></div>
            </div>
        </div>

        <div class="panel">
            <h3>Åehir & YaÅŸam</h3>
            <button class="btn-market" onclick="visitMarket()">ğŸ½ï¸ Markete Git (-â‚º500)</button>
            <button class="btn-mosque" onclick="visitMosque()">ğŸ•Œ Camiye Git (Bedava)</button>
            <hr style="border-color:#444">
            <h3>Ä°ÅŸletme</h3>
            <div style="margin-bottom:10px; font-size:0.9em;">
                Galeri Seviyesi: <span id="levelDisplay" style="color:var(--accent-gold); font-weight:bold;">1</span><br>
                <small id="nextLevelCost">YÃ¼kseltme: â‚º1.000.000</small>
            </div>
            <button class="btn-upgrade" onclick="upgradeGallery()">â¬†ï¸ Galeriyi BÃ¼yÃ¼t</button>
            <button class="btn-next" onclick="nextDay()">ğŸŒ™ GÃ¼nÃ¼ Bitir</button>
        </div>
        
        <div class="panel log-box" id="logBox">
            <div class="log-item info">Oyun baÅŸladÄ±. HayÄ±rlÄ± iÅŸler!</div>
        </div>
    </div>

    <div class="right-col">
        <div class="panel">
            <h3>Piyasa Durumu: <span id="marketStatus">Normal</span></h3>
            <p style="font-size:0.9em; color:#bbb;">BugÃ¼nkÃ¼ alÄ±m-satÄ±m Ã§arpanÄ±: <span id="marketMultiplier">1.00</span>x</p>
        </div>

        <div class="panel">
            <h3>Gelen Teklif (Telefon) ğŸ“±</h3>
            <div id="offerSection" class="offer-box">
                <p>Åu an arayan soran yok.</p>
            </div>
        </div>

        <div class="panel">
            <h3>GarajÄ±mdaki AraÃ§lar (<span id="carCount">0</span>)</h3>
            <div id="inventoryList">
                </div>
        </div>
    </div>
</div>

<script>
// --- VERÄ°TABANI (ARABALAR) ---
const carDatabase = [
    // SEVÄ°YE 1 ARAÃ‡LARI
    { id: 1, name: "TofaÅŸ Åahin", basePrice: 200000, level: 1 },
    { id: 2, name: "Renault Toros", basePrice: 180000, level: 1 },
    { id: 3, name: "Fiat Uno", basePrice: 150000, level: 1 },
    // SEVÄ°YE 2 ARAÃ‡LARI
    { id: 4, name: "Fiat Egea", basePrice: 800000, level: 2 },
    { id: 5, name: "Renault Clio", basePrice: 750000, level: 2 },
    { id: 6, name: "Ford Focus", basePrice: 900000, level: 2 },
    // SEVÄ°YE 3 ARAÃ‡LARI
    { id: 7, name: "Honda Civic", basePrice: 1200000, level: 3 },
    { id: 8, name: "VW Passat", basePrice: 1500000, level: 3 },
    // SEVÄ°YE 4 ARAÃ‡LARI
    { id: 9, name: "BMW 320i", basePrice: 2500000, level: 4 },
    { id: 10, name: "Mercedes C200", basePrice: 2800000, level: 4 }
];

// --- OYUN DEÄÄ°ÅKENLERÄ° ---
let gameState = {
    money: 300000,
    day: 1,
    level: 1,
    galleryName: "Tuna Motors",
    stats: {
        hunger: 20, // 0-100 (100 olunca Ã¶lÃ¼rsÃ¼n)
        stress: 10, // 0-100
        faith: 50   // 0-100 (DÃ¼ÅŸerse stres hÄ±zlÄ± artar)
    },
    inventory: [],
    currentOffer: null,
    marketMultiplier: 1.0
};

// --- BAÅLANGIÃ‡ ---
updateUI();
generateOffer();

// --- FONKSÄ°YONLAR ---

function log(msg, type="info") {
    const box = document.getElementById("logBox");
    const div = document.createElement("div");
    div.className = `log-item ${type}`;
    div.innerText = `GÃ¼n ${gameState.day}: ${msg}`;
    box.prepend(div);
}

function updateUI() {
    // Header
    document.getElementById("moneyDisplay").innerText = "â‚º" + gameState.money.toLocaleString();
    document.getElementById("dayDisplay").innerText = "GÃ¼n: " + gameState.day;
    document.getElementById("galleryNameDisplay").innerText = gameState.galleryName;
    document.getElementById("levelDisplay").innerText = gameState.level;
    document.getElementById("carCount").innerText = gameState.inventory.length;

    // Bars
    document.getElementById("hungerBar").style.width = gameState.stats.hunger + "%";
    document.getElementById("stressBar").style.width = gameState.stats.stress + "%";
    document.getElementById("faithBar").style.width = gameState.stats.faith + "%";

    // Renk deÄŸiÅŸimleri (UyarÄ±)
    document.getElementById("hungerBar").style.background = gameState.stats.hunger > 80 ? "red" : "#4caf50";
    
    // Upgrade Cost
    const upgradeCost = gameState.level * 1000000;
    document.getElementById("nextLevelCost").innerText = gameState.level < 4 ? `YÃ¼kseltme: â‚º${upgradeCost.toLocaleString()}` : "Maksimum Seviye";

    renderInventory();
}

// Ä°sim DeÄŸiÅŸtirme
function toggleNameEdit() {
    const section = document.getElementById("editNameSection");
    section.style.display = section.style.display === "none" ? "block" : "none";
}
function changeName() {
    const newName = document.getElementById("newNameInput").value;
    if(newName.trim() !== "") {
        gameState.galleryName = newName;
        toggleNameEdit();
        updateUI();
        log("Galeri ismi deÄŸiÅŸti: " + newName, "good");
    }
}

// GÃ¼nlÃ¼k DÃ¶ngÃ¼
function nextDay() {
    gameState.day++;
    
    // Stat DeÄŸiÅŸimleri
    gameState.stats.hunger += 20;
    gameState.stats.faith -= 10;
    
    // Ä°man dÃ¼ÅŸÃ¼kse stres artar
    if(gameState.stats.faith < 30) {
        gameState.stats.stress += 25;
        log("Ä°man zayÄ±fladÄ±, iÃ§in daralÄ±yor (Stres++)", "bad");
    } else {
        gameState.stats.stress += 5;
    }

    // SÄ±nÄ±rlar
    clampStats();

    // Game Over KontrolÃ¼
    if(gameState.stats.hunger >= 100) {
        alert("AÃ§lÄ±ktan bayÄ±ldÄ±n! Hastane masraflarÄ±: â‚º50.000");
        gameState.money -= 50000;
        gameState.stats.hunger = 50;
    }
    if(gameState.stats.stress >= 100) {
        alert("Sinir krizi geÃ§irdin! Dinlenmek zorundasÄ±n. (3 GÃ¼n KayÄ±p)");
        gameState.day += 3;
        gameState.stats.stress = 20;
    }
    if(gameState.money < 0) {
        alert("Ä°FLAS ETTÄ°N! OYUN BÄ°TTÄ°.");
        location.reload();
        return;
    }

    // Piyasa DalgalanmasÄ±
    randomizeMarket();
    
    // Yeni Teklif
    generateOffer();
    
    updateUI();
}

function clampStats() {
    gameState.stats.hunger = Math.min(100, Math.max(0, gameState.stats.hunger));
    gameState.stats.stress = Math.min(100, Math.max(0, gameState.stats.stress));
    gameState.stats.faith = Math.min(100, Math.max(0, gameState.stats.faith));
}

function randomizeMarket() {
    // 0.8 (Kriz) ile 1.3 (CanlÄ±) arasÄ±
    gameState.marketMultiplier = (Math.random() * 0.5 + 0.8).toFixed(2);
    
    const statusText = document.getElementById("marketStatus");
    const multText = document.getElementById("marketMultiplier");
    
    multText.innerText = gameState.marketMultiplier;
    
    if(gameState.marketMultiplier < 0.9) {
        statusText.innerText = "Durgun ğŸ“‰";
        statusText.style.color = "red";
    } else if (gameState.marketMultiplier > 1.1) {
        statusText.innerText = "CanlÄ± ğŸ”¥";
        statusText.style.color = "green";
    } else {
        statusText.innerText = "Normal â˜ï¸";
        statusText.style.color = "white";
    }
}

// NPC Teklif Sistemi
function generateOffer() {
    // Seviyemize uygun arabalarÄ± filtrele
    const availableCars = carDatabase.filter(c => c.level <= gameState.level);
    const randomCar = availableCars[Math.floor(Math.random() * availableCars.length)];
    
    // Fiyat biraz rastgele olsun (HasarlÄ±/Temiz gibi)
    const variation = (Math.random() * 0.4) - 0.2; // %20 ucuz veya pahalÄ± olabilir
    const offerPrice = Math.floor(randomCar.basePrice * (1 + variation));
    
    gameState.currentOffer = { ...randomCar, offerPrice: offerPrice, condition: variation };
    
    const offerDiv = document.getElementById("offerSection");
    
    let conditionText = "Temiz";
    if(variation < -0.1) conditionText = "Hasar KayÄ±tlÄ± (Ucuz)";
    else if(variation > 0.1) conditionText = "HatasÄ±z BoyasÄ±z (PahalÄ±)";

    offerDiv.innerHTML = `
        <h4 style="margin:0">${randomCar.name}</h4>
        <p style="color:#aaa">${conditionText}</p>
        <p style="font-size:1.2em; font-weight:bold;">Fiyat: â‚º${offerPrice.toLocaleString()}</p>
        <button class="btn-buy" onclick="buyCar()">SatÄ±n Al</button>
        <button class="btn-action" style="background:#555" onclick="rejectOffer()">Reddet</button>
    `;
}

function buyCar() {
    if(!gameState.currentOffer) return;
    
    if(gameState.money >= gameState.currentOffer.offerPrice) {
        gameState.money -= gameState.currentOffer.offerPrice;
        gameState.inventory.push(gameState.currentOffer);
        log(`${gameState.currentOffer.name} satÄ±n alÄ±ndÄ±.`, "good");
        
        document.getElementById("offerSection").innerHTML = "<p>SatÄ±cÄ± parayÄ± alÄ±p gitti.</p>";
        gameState.currentOffer = null;
        updateUI();
    } else {
        alert("Paran yetmiyor kardo!");
    }
}

function rejectOffer() {
    document.getElementById("offerSection").innerHTML = "<p>Teklifi reddettin.</p>";
    gameState.currentOffer = null;
}

// Envanter ve SatÄ±ÅŸ
function renderInventory() {
    const list = document.getElementById("inventoryList");
    list.innerHTML = "";
    
    gameState.inventory.forEach((car, index) => {
        // SatÄ±ÅŸ fiyatÄ±nÄ± piyasaya gÃ¶re belirle
        // Base Price * Market * (Rastgele Åans)
        const marketValue = Math.floor(car.basePrice * gameState.marketMultiplier);
        
        const div = document.createElement("div");
        div.className = "car-item";
        div.innerHTML = `
            <div>
                <strong>${car.name}</strong><br>
                <small>AlÄ±ÅŸ: â‚º${car.offerPrice.toLocaleString()}</small>
            </div>
            <div>
                <button class="btn-sell" onclick="sellCar(${index}, ${marketValue})" style="width:auto; font-size:12px;">
                    Sat (â‚º${marketValue.toLocaleString()})
                </button>
            </div>
        `;
        list.appendChild(div);
    });
}

function sellCar(index, salePrice) {
    const car = gameState.inventory[index];
    const profit = salePrice - car.offerPrice;
    
    gameState.money += salePrice;
    gameState.inventory.splice(index, 1);
    
    if(profit > 0) log(`${car.name} satÄ±ldÄ±. KÃ¢r: â‚º${profit.toLocaleString()}`, "good");
    else log(`${car.name} zararÄ±na satÄ±ldÄ±. Zarar: â‚º${Math.abs(profit).toLocaleString()}`, "bad");
    
    updateUI();
}

// Eylemler
function visitMarket() {
    if(gameState.money >= 500) {
        gameState.money -= 500;
        gameState.stats.hunger = Math.max(0, gameState.stats.hunger - 40);
        log("YarÄ±m ekmek dÃ¶ner yedin. AÃ§lÄ±k azaldÄ±.", "good");
        updateUI();
    } else {
        alert("Paran yok, simit bile alamazsÄ±n!");
    }
}

function visitMosque() {
    gameState.stats.faith = Math.min(100, gameState.stats.faith + 40);
    gameState.stats.stress = Math.max(0, gameState.stats.stress - 30);
    log("Cumaya gittin, huzur buldun. Ä°man++ Stres--", "good");
    updateUI();
}
    // --- ARABA (FOTOÄRAFLI) ---
// Not: AÅŸaÄŸÄ±daki URL'yi kendi araba resminin linkiyle deÄŸiÅŸtirebilirsin.
// Kare veya dikdÃ¶rtgen bir "texture" (doku) gÃ¶rseli en iyi sonucu verir.
const carTextureUrl = 'https://th.bing.com/th/id/R.cad03b32052be58d34980d41b80fa82f?rik=DsNeJTTsT9G6bg&riu=http%3a%2f%2f4.bp.blogspot.com%2f-VSHZLPLGBe0%2fVbvd5MZawyI%2fAAAAAAAAAIs%2fDqaS_4LXUpg%2fw1200-h630-p-k-no-nu%2f1200px-Renault_12TSW_Toros_front.jpg&ehk=6ZDAjWmuRbtHno5A4cdEhHZdIYsF4WU23mI9yCznt2w%3d&risl=&pid=ImgRaw&r=0; 
// (Åimdilik Ã¶rnek olarak ahÅŸap kutu dokusu koydum, araba yan/Ã¼st gÃ¶rÃ¼nÃ¼ÅŸÃ¼ bulursan buraya yapÄ±ÅŸtÄ±r)

const carTexture = textureLoader.load(carTextureUrl);
const carGeometry = new THREE.BoxGeometry(1.5, 0.8, 2.5); // Araba boyutunu biraz bÃ¼yÃ¼ttÃ¼m
const carMaterial = new THREE.MeshStandardMaterial({ 
    map: carTexture, // FOTOÄRAFI BURADA ATIYORUZ
    color: 0xffffff // Resmin rengini bozmamak iÃ§in beyaz taban
});

const car = new THREE.Mesh(carGeometry, carMaterial);
car.position.y = 0.4;
car.castShadow = true; // GÃ¶lge dÃ¼ÅŸÃ¼rsÃ¼n
scene.add(car);

function upgradeGallery() {
    const cost = gameState.level * 1000000;
    if(gameState.level >= 4) {
        alert("Zaten en Ã¼st seviyedesin!");
        return;
    }
    
    if(gameState.money >= cost) {
        gameState.money -= cost;
        gameState.level++;
        log(`Tebrikler! Galeri Seviye ${gameState.level} oldu. ArtÄ±k daha lÃ¼ks arabalar alabilirsin!`, "good");
        updateUI();
    } else {
        alert("Yeterli paran yok!");
    }
}

</script>

</body>
</html>
