<!DOCTYPE html>
<html lang="tr">
<head>
<meta charset="UTF-8">
<title>Galeri Tycoon: Full SimÃ¼lasyon</title>
<style>
    :root { --bg: #0a0a0a; --gold: #ffd700; --red: #ff4d4d; --green: #2ecc71; --blue: #3498db; }
    body { margin: 0; background: var(--bg); color: #fff; font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; overflow: hidden; }
    
    #ui { position: absolute; width: 100%; height: 100%; pointer-events: none; z-index: 10; display: flex; flex-direction: column; padding: 20px; box-sizing: border-box; }
    .panel { pointer-events: auto; background: rgba(20,20,20,0.9); border: 1px solid #333; border-radius: 12px; padding: 15px; box-shadow: 0 0 20px rgba(0,0,0,0.7); }

    /* ÃœST PANEL */
    .status-bar { display: flex; gap: 20px; justify-content: space-between; align-items: center; }
    .bar-wrap { width: 100px; height: 12px; background: #222; border-radius: 6px; overflow: hidden; border: 1px solid #444; }
    .bar-fill { height: 100%; transition: 0.5s; width: 50%; }

    /* ANA OYUN ALANI */
    .game-layout { display: flex; justify-content: space-between; height: 75%; margin-top: 20px; }
    
    /* SOL: HARÄ°TA/BÃ–LGE SEÃ‡Ä°MÄ° */
    .map-nav { width: 220px; display: flex; flex-direction: column; gap: 10px; }
    .nav-item { padding: 15px; border-radius: 8px; background: #1a1a1a; cursor: pointer; text-align: center; border: 1px solid #333; transition: 0.3s; }
    .nav-item:hover { border-color: var(--blue); background: #252525; }
    .nav-item.active { background: var(--blue); border-color: #fff; }

    /* ORTA: ETKÄ°LEÅÄ°M ALANI */
    .action-center { flex: 1; display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center; }
    .npc-box { font-size: 5em; margin-bottom: 10px; animation: float 3s infinite ease-in-out; }
    @keyframes float { 0%, 100% { transform: translateY(0); } 50% { transform: translateY(-15px); } }

    /* SAÄ: GÃœNCEL ARABA VE KONTROLLER */
    .car-info { width: 280px; }
    .btn { width: 100%; padding: 12px; border: none; border-radius: 6px; font-weight: bold; cursor: pointer; color: white; margin-top: 10px; }
    .btn-green { background: var(--green); }
    .btn-blue { background: var(--blue); }
    .btn-red { background: var(--red); }
    .btn-gold { background: var(--gold); color: #000; }

    input#galName { background: none; border: 1px dashed #555; color: var(--gold); text-align: center; font-size: 1.2em; width: 100%; margin-bottom: 10px; }
    
    #msg { position: fixed; top: 20%; left: 50%; transform: translate(-50%, -50%); background: var(--red); padding: 20px; border-radius: 10px; display: none; z-index: 1000; }
</style>
</head>
<body>

<div id="msg"></div>

<div id="ui">
    <div class="panel status-bar">
        <div style="color:var(--gold); font-weight:bold; font-size: 1.2em;">ğŸ’° <span id="m-val">300.000</span></div>
        <div>ğŸ• AÃ§lÄ±k <div class="bar-wrap"><div id="b-hunger" class="bar-fill" style="background:var(--red)"></div></div></div>
        <div>ğŸ§˜ Stres <div class="bar-wrap"><div id="b-stress" class="bar-fill" style="background:var(--gold)"></div></div></div>
        <div>ğŸ•Œ Ä°man <div class="bar-wrap"><div id="b-faith" class="bar-fill" style="background:var(--green)"></div></div></div>
        <div style="color:var(--blue)">ğŸ“… <span id="d-val">Pzt</span></div>
    </div>

    <div class="game-layout">
        <div class="map-nav">
            <div class="nav-item active" id="nav-galeri" onclick="go('galeri')">ğŸ¢ Galeri Merkez</div>
            <div class="nav-item" id="nav-mahalle" onclick="go('mahalle')">ğŸ˜ï¸ Mahalle (Cami/Market)</div>
            <div class="nav-item" id="nav-sanayi" onclick="go('sanayi')">ğŸ”§ Sanayi Sitesi</div>
            <div class="nav-item" id="nav-tefeci" onclick="go('tefeci')">ğŸ’€ Tefeci MekanÄ±</div>
            <button class="btn btn-red" onclick="nextDay()" style="margin-top:auto">ğŸŒ™ GÃ¼nÃ¼ Bitir</button>
        </div>

        <div class="action-center">
            <div id="npc-avatar" class="npc-box">ğŸ¤µ</div>
            <h2 id="npc-title" style="margin:5px 0">HoÅŸgeldin Kral</h2>
            <p id="npc-speech" style="max-width: 400px; font-style: italic;">"BugÃ¼n galeri iÃ§in gÃ¼zel bir gÃ¼n!"</p>
            
            <div id="action-btns" style="pointer-events: auto; width: 300px;">
                </div>
        </div>

        <div class="panel car-info">
            <input type="text" id="galName" value="TUNA GALERÄ°">
            <div id="car-preview" style="height: 150px; border: 1px solid #333; margin-bottom: 10px; display: flex; align-items: center; justify-content: center; font-size: 4em;">ğŸ¢</div>
            <h3 id="car-name" style="text-align:center; margin:0">AraÃ§ Yok</h3>
            <p id="car-stat" style="text-align:center; color:#888; font-size:0.9em">Piyasa: -</p>
            <div id="car-ctrl" style="pointer-events: auto;">
                 <button class="btn btn-blue" id="main-act-btn" onclick="pazarAra()">ğŸš— Araba Ara</button>
            </div>
        </div>
    </div>
</div>

<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r128/three.min.js"></script>
<script>
// --- OYUN VERÄ°SÄ° ---
const carModels = [
    {n:"TofaÅŸ Åahin", p:250000, c:0xffffff, icon:"ğŸš—"}, {n:"Toros", p:180000, c:0xdddddd, icon:"ğŸš™"},
    {n:"BMW M4", p:5500000, c:0x0000ff, icon:"ğŸï¸"}, {n:"Mercedes G63", p:15000000, c:0x222222, icon:"ğŸšœ"},
    {n:"Bugatti", p:90000000, c:0x0000bb, icon:"ğŸš€"}
];

let state = {
    money: 300000, hunger: 20, stress: 10, faith: 50, day: 0,
    loc: 'galeri', car: null, npcPrice: 0, tempCar: null
};

// --- THREE.JS (GELÄ°ÅMÄ°Å ARABA MODELÄ°) ---
const scene = new THREE.Scene();
const camera = new THREE.PerspectiveCamera(75, window.innerWidth/window.innerHeight, 0.1, 1000);
const renderer = new THREE.WebGLRenderer({antialias:true, alpha:true});
renderer.setSize(window.innerWidth, window.innerHeight);
document.body.appendChild(renderer.domElement);

const carGroup = new THREE.Group();
const body = new THREE.Mesh(new THREE.BoxGeometry(2.2, 0.7, 4.5), new THREE.MeshStandardMaterial({color: 0xffffff}));
const top = new THREE.Mesh(new THREE.BoxGeometry(1.8, 0.6, 2.2), new THREE.MeshStandardMaterial({color: 0xffffff}));
top.position.y = 0.6; top.position.z = -0.3;
const wheelGeo = new THREE.CylinderGeometry(0.4, 0.4, 0.3, 16);
const wheelMat = new THREE.MeshStandardMaterial({color: 0x111111});
for(let x=-1; x<=1; x+=2) for(let z=-1.5; z<=1.5; z+=3) {
    let w = new THREE.Mesh(wheelGeo, wheelMat);
    w.rotation.z = Math.PI/2; w.position.set(x*1.1, -0.3, z);
    carGroup.add(w);
}
carGroup.add(body, top); scene.add(carGroup);
scene.add(new THREE.AmbientLight(0xffffff, 0.6));
const light = new THREE.DirectionalLight(0xffffff, 1); light.position.set(5,10,5); scene.add(light);
camera.position.set(6, 4, 8); camera.lookAt(0,0,0);

// --- OYUN FONKSÄ°YONLARI ---

function go(target) {
    state.loc = target;
    document.querySelectorAll('.nav-item').forEach(el => el.classList.remove('active'));
    document.getElementById('nav-' + target).classList.add('active');
    
    const btns = document.getElementById('action-btns');
    btns.innerHTML = "";
    
    if(target === 'galeri') {
        setNPC("ğŸ¤µ", "Galerici Mahmut", "Piyasa bugÃ¼nlerde Ã§ok hareketli!");
    } else if(target === 'mahalle') {
        setNPC("ğŸ‘³", "HacÄ± Abi", "Selamun aleykÃ¼m evlat, huzur burada.");
        btns.innerHTML = `<button class="btn btn-green" onclick="pray()">ğŸ•Œ Namaz KÄ±l (Ä°man +30)</button>
                          <button class="btn btn-gold" onclick="eat()">ğŸ›’ Marketten Doy (-â‚º2k)</button>`;
    } else if(target === 'sanayi') {
        setNPC("ğŸ‘¨â€ğŸ”§", "Usta Nuri", "Getir arabayÄ± da bir ayar Ã§ekelim.");
        if(state.car) btns.innerHTML = `<button class="btn btn-blue" onclick="modify()">ğŸ› ï¸ Modifiye Yap (-â‚º100k)</button>`;
    } else if(target === 'tefeci') {
        setNPC("ğŸ•¶ï¸", "Tefeci Remzi", "Para lazÄ±m mÄ± koÃ§um? Ama vaktinde Ã¶de!");
        btns.innerHTML = `<button class="btn btn-red" onclick="kredi()">ğŸ’° â‚º200k Kredi Ã‡ek</button>`;
    }
    updateUI();
}

function setNPC(icon, name, speech) {
    document.getElementById('npc-avatar').innerText = icon;
    document.getElementById('npc-title').innerText = name;
    document.getElementById('npc-speech').innerText = `"${speech}"`;
}

function updateUI() {
    document.getElementById('m-val').innerText = state.money.toLocaleString();
    document.getElementById('b-hunger').style.width = state.hunger + "%";
    document.getElementById('b-stress').style.width = state.stress + "%";
    document.getElementById('b-faith').style.width = state.faith + "%";
    document.getElementById('d-val').innerText = ["Pzt", "Sal", "Ã‡ar", "Per", "Cum", "Cmt", "Paz"][state.day];

    if(state.car) {
        document.getElementById('car-preview').innerText = state.car.icon;
        document.getElementById('car-name').innerText = state.car.n;
        document.getElementById('car-stat').innerText = "DeÄŸer: â‚º" + (state.car.p).toLocaleString();
        document.getElementById('main-act-btn').innerText = "ğŸ’° MÃ¼ÅŸteri Ara";
        document.getElementById('main-act-btn').onclick = satisBaslat;
        body.material.color.setHex(state.car.c); top.material.color.setHex(state.car.c);
        carGroup.visible = true;
    } else {
        document.getElementById('car-preview').innerText = "ğŸ¢";
        document.getElementById('car-name').innerText = "AraÃ§ Yok";
        document.getElementById('main-act-btn').innerText = "ğŸš— Araba Ara";
        document.getElementById('main-act-btn').onclick = pazarAra;
        carGroup.visible = false;
    }
}

function pazarAra() {
    if(state.loc !== 'galeri') { alert("Araba bakmak iÃ§in Galeriye gitmelisin!"); return; }
    let car = carModels[Math.floor(Math.random()*carModels.length)];
    state.tempCar = car;
    state.npcPrice = Math.floor(car.p * (0.9 + Math.random() * 0.3));
    setNPC("ğŸ‘¤", "SatÄ±cÄ±", `Bu ${car.n} iÃ§in â‚º${state.npcPrice.toLocaleString()} istiyorum. Ne dersin?`);
    document.getElementById('action-btns').innerHTML = `
        <button class="btn btn-green" onclick="buyConfirm()">âœ… SatÄ±n Al</button>
        <button class="btn btn-blue" onclick="negotiate(true)">ğŸ¤ PazarlÄ±k Yap</button>
    `;
}

function negotiate(buyMode) {
    if(state.faith > 70) {
        state.npcPrice = Math.floor(state.npcPrice * 0.9);
        setNPC("ğŸ‘¤", "SatÄ±cÄ±", `GÃ¼zel konuÅŸtun, â‚º${state.npcPrice.toLocaleString()} olsun o zaman.`);
    } else {
        state.stress += 10;
        setNPC("ğŸ‘¤", "SatÄ±cÄ±", "Nuh diyorum peygamber demiyorum, son fiyat!");
    }
}

function buyConfirm() {
    if(state.money >= state.npcPrice) {
        state.money -= state.npcPrice;
        state.car = state.tempCar;
        state.tempCar = null;
        go('galeri');
    } else alert("Para yetmiyor!");
}

function satisBaslat() {
    let customerPrice = Math.floor(state.car.p * (0.8 + Math.random() * 0.5));
    state.npcPrice = customerPrice;
    setNPC("ğŸ¤µ", "MÃ¼ÅŸteri", `ArabanÄ±za â‚º${customerPrice.toLocaleString()} veririm. Satar mÄ±sÄ±nÄ±z?`);
    document.getElementById('action-btns').innerHTML = `
        <button class="btn btn-green" onclick="sellConfirm()">ğŸ¤ SatÄ±yorum</button>
        <button class="btn btn-blue" onclick="negotiate(false)">ğŸ’¹ Fiyat ArttÄ±r</button>
    `;
}

function sellConfirm() {
    state.money += state.npcPrice;
    state.car = null;
    go('galeri');
}

function pray() { state.faith = 100; state.stress = 0; alert("Huzur doldu iÃ§in..."); updateUI(); }
function eat() { state.money -= 2000; state.hunger = 0; updateUI(); }
function modify() { state.money -= 100000; state.car.p += 250000; alert("Usta canavar yaptÄ±!"); updateUI(); }
function kredi() { state.money += 200000; alert("Tefeci: GÃ¶zÃ¼m Ã¼zerinde..."); updateUI(); }

function nextDay() {
    state.day++; if(state.day > 6) state.day = 0;
    state.hunger += 20;
    if(state.day === 6) { state.money = Math.floor(state.money * 0.85); alert("Pazar vergisi kesildi!"); }
    go('galeri');
}

function animate() { requestAnimationFrame(animate); carGroup.rotation.y += 0.01; renderer.render(scene, camera); }
animate();
updateUI();
</script>
</body>
</html>
