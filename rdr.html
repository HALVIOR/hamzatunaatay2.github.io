<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <title>RDR 2: Halvior Edition</title>
    <style>
        body { margin: 0; overflow: hidden; background: #5d4037; font-family: 'Georgia', serif; }
        #arayuz { position: absolute; top: 20px; left: 20px; color: #ffcc00; background: rgba(40, 20, 0, 0.9); padding: 15px; border: 3px double #8b4513; border-radius: 8px; pointer-events: none; box-shadow: 0 0 15px rgba(0,0,0,0.5); }
        #alt-yazi { position: absolute; bottom: 40px; left: 50%; transform: translateX(-50%); width: 70%; background: rgba(0,0,0,0.85); color: #ddd; padding: 20px; border-left: 10px solid #8b0000; display: none; text-align: center; font-size: 1.3em; border-radius: 5px; }
        canvas { display: block; cursor: crosshair; }
    </style>
</head>
<body>

<div id="arayuz">
    <div style="font-size: 22px; font-weight: bold; border-bottom: 1px solid #ffcc00; margin-bottom: 5px;">ü§† HALVIOR FRONTIER</div>
    üí∞ Altƒ±n: <span id="para">150</span> | ‚ù§Ô∏è Saƒülƒ±k: <span id="can">100</span><br>
    <div id="gorev" style="color: #ff4500; font-weight: bold; margin-top: 5px;">G√ñREV: Dutch ile konu≈ü (Kƒ±rmƒ±zƒ± Tip)</div>
    <hr>
    <small style="color: #bbb;">WASD: Hareket | F: Racon Kes | E: At Bin/ƒ∞n | Sol Click: Ate≈ü</small>
</div>

<div id="alt-yazi"></div>

<canvas id="oyun"></canvas>

<script>
    const canvas = document.getElementById('oyun');
    const ctx = canvas.getContext('2d');
    canvas.width = window.innerWidth;
    canvas.height = window.innerHeight;

    let oyuncu = { x: 500, y: 500, aci: 0, atUstunde: false, can: 100 };
    let kamera = { x: 0, y: 0 };
    let mermiler = [];
    let fare = { x: 0, y: 0 };

    // Binalar (Detaylƒ± Modeller)
    const binalar = [
        { x: 200, y: 100, w: 200, h: 250, isim: "SALOON", renk: "#4e342e" },
        { x: 800, y: 300, w: 150, h: 200, isim: "≈ûERƒ∞F", renk: "#3e2723" },
        { x: 400, y: 700, w: 300, h: 150, isim: "AHIR", renk: "#5d4037" }
    ];

    // NPC'ler (Modellenmi≈ü)
    const npcler = [
        { x: 300, y: 300, renk: "red", isim: "Dutch", diyalog: "Dutch: 'Halvior! Bir planƒ±m var, sadece 5 dolar ve biraz sadakat lazƒ±m evlat!'" },
        { x: 850, y: 450, renk: "blue", isim: "≈ûerif", diyalog: "≈ûerif: 'Yine mi sen Halvior? O atƒ± kaldƒ±rƒ±ma √ßekme demedim mi!'" }
    ];

    let at = { x: 600, y: 600, aci: 0 };

    const raconlar = [
        "Halvior: 'Azdan az, √ßoktan √ßok gider ko√ßum!'",
        "Halvior: 'Tahiti mi? Dutch, biz daha mahalleden √ßƒ±kamadƒ±k...'",
        "Halvior: 'Sƒ±kƒ±ysa ate≈ü et, bu 2D d√ºnyada mermiden hƒ±zlƒ±yƒ±m!'",
        "Halvior: 'Racon bitmi≈ütir, ≈üimdi daƒüƒ±lƒ±n!'"
    ];

    window.onmousemove = (e) => { fare.x = e.clientX + kamera.x; fare.y = e.clientY + kamera.y; };
    window.onmousedown = () => { if(!oyuncu.atUstunde) mermiAt(); };

    window.onkeydown = (e) => { 
        if(e.code === 'KeyF') diyalogGoster();
        if(e.code === 'KeyE') {
            if(Math.hypot(oyuncu.x - at.x, oyuncu.y - at.y) < 60) oyuncu.atUstunde = !oyuncu.atUstunde;
        }
        tuslar[e.code] = true;
    };
    window.onkeyup = (e) => tuslar[e.code] = false;
    let tuslar = {};

    function mermiAt() {
        let aci = Math.atan2(fare.y - oyuncu.y, fare.x - oyuncu.x);
        mermiler.push({ x: oyuncu.x, y: oyuncu.y, vx: Math.cos(aci)*15, vy: Math.sin(aci)*15 });
    }

    function diyalogGoster() {
        const box = document.getElementById('alt-yazi');
        let mesaj = raconlar[Math.floor(Math.random()*raconlar.length)];
        
        // Yakƒ±n NPC var mƒ± kontrol√º
        npcler.forEach(n => {
            if(Math.hypot(oyuncu.x - n.x, oyuncu.y - n.y) < 70) mesaj = n.diyalog;
        });

        box.innerText = mesaj;
        box.style.display = 'block';
        setTimeout(() => box.style.display = 'none', 4000);
    }

    function karakterCiz(x, y, aci, renk, isim) {
        ctx.save();
        ctx.translate(x, y);
        ctx.rotate(aci);
        // G√∂vde ve ≈ûapka
        ctx.fillStyle = renk; ctx.fillRect(-15, -15, 30, 30);
        ctx.fillStyle = "black"; ctx.fillRect(-20, -18, 40, 5); // ≈ûapka siperi
        // G√∂zler
        ctx.fillStyle = "white"; ctx.fillRect(5, -10, 5, 5); ctx.fillRect(5, 5, 5, 5);
        ctx.restore();
        ctx.fillStyle = "white"; ctx.font = "12px Arial";
        ctx.fillText(isim, x - 20, y - 25);
    }

    function d√∂ng√º() {
        ctx.setTransform(1,0,0,1,0,0);
        ctx.fillStyle = "#d2b48c"; ctx.fillRect(0, 0, canvas.width, canvas.height);
        ctx.translate(-kamera.x, -kamera.y);

        // Yer Detaylarƒ± (Otlar ve Ta≈ülar)
        ctx.fillStyle = "#a1887f";
        for(let i=0; i<2000; i+=300) {
            for(let j=0; j<2000; j+=300) ctx.fillRect(i, j, 5, 5);
        }

        // Binalarƒ± √áiz (Pencereli)
        binalar.forEach(b => {
            ctx.fillStyle = b.renk; ctx.fillRect(b.x, b.y, b.w, b.h);
            ctx.strokeStyle = "#2e1910"; ctx.lineWidth = 4; ctx.strokeRect(b.x, b.y, b.w, b.h);
            ctx.fillStyle = "#ffeb3b"; // Pencereler
            ctx.fillRect(b.x+20, b.y+40, 30, 30); ctx.fillRect(b.x+b.w-50, b.y+40, 30, 30);
            ctx.fillStyle = "white"; ctx.fillText(b.isim, b.x + b.w/2 - 20, b.y + 20);
        });

        // Atƒ± √áiz
        ctx.fillStyle = "#6d4c41"; 
        ctx.fillRect(at.x - 30, at.y - 15, 60, 30);
        ctx.fillStyle = "#3e2723"; ctx.fillRect(at.x+20, at.y-10, 15, 10); // Kafa

        // NPC ve Oyuncu
        npcler.forEach(n => karakterCiz(n.x, n.y, 0, n.renk, n.isim));
        
        if(!oyuncu.atUstunde) {
            oyuncu.aci = Math.atan2(fare.y - oyuncu.y, fare.x - oyuncu.x);
            karakterCiz(oyuncu.x, oyuncu.y, oyuncu.aci, "#2196f3", "HALVIOR");
        } else {
            at.x = oyuncu.x; at.y = oyuncu.y;
        }

        // Mermiler
        ctx.fillStyle = "yellow";
        mermiler.forEach((m, i) => {
            m.x += m.vx; m.y += m.vy;
            ctx.fillRect(m.x, m.y, 10, 3);
            if(Math.abs(m.x) > 3000) mermiler.splice(i, 1);
        });

        // G√ºncelleme
        let hiz = oyuncu.atUstunde ? 8 : 4;
        if(tuslar['KeyW']) oyuncu.y -= hiz;
        if(tuslar['KeyS']) oyuncu.y += hiz;
        if(tuslar['KeyA']) oyuncu.x -= hiz;
        if(tuslar['KeyD']) oyuncu.x += hiz;

        kamera.x = oyuncu.x - canvas.width/2;
        kamera.y = oyuncu.y - canvas.height/2;

        requestAnimationFrame(d√∂ng√º);
    }
    d√∂ng√º();
</script>
</body>
</html>
